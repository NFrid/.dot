#!/bin/bash

NOTES_DIR="$HOME/Documents/Notes"

runvim() {
  alacritty -e $SHELL -c "nvim '$NOTES_DIR/$1.md'"
}

notes=$(find "$NOTES_DIR/" -name "*.md" -exec basename {} .md ";")

[[ -z "$1" ]] || runvim $1 && exit 0

sel=$(echo -e "$notes\n:new\n:rm\n:mv" | dmenu -p 'note')

case $sel in
  :rm)
    sel=$(echo "$notes" | dmenu -p 'rm')
    rm "$NOTES_DIR/$sel.md"
    ;;
  :mv)
    sel=$(echo "$notes" | dmenu -p 'mv')
    nsel=$(dmenu -p 'as')
    mv "$NOTES_DIR/$sel.md" "$NOTES_DIR/$nsel.md"
    ;;
  :new)
    sel=$(dmenu -p 'new')
    echo "# $sel" >> "$NOTES_DIR/$sel.md"
    runvim "$sel"
    ;;
  *)
    [[ -z "$sel" ]] || runvim "$sel"
  ;;
esac
